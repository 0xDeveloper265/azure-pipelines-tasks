# Windows Machine File Copy Task
| S.NO | Target Machine State                                       | Target Machine trust with Automation agent | Machine Identity | Authentication Account                    | Authentication Mode | Authentication Account permission on Target Machine | Connection Type | Pre-requisites in Target machine for Copy Task to succeed                                                                                                                                                                                                                                                                                                                                                                                                                    | Pre-requisites in Target machine for Deployment Task to succeed                                                                                                                                                                                                                                                |
|------|------------------------------------------------------------|--------------------------------------------|------------------|-------------------------------------------|---------------------|-----------------------------------------------------|-----------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1    | Domain joined machine in Corp network                      | Trusted                                    | DNS name         | Domain account                            | Kerberos            | Machine Administrator                               | WinRM HTTP      | <ul><li>WinRM HTTP port,(default 5985) opened in Firewall.</li><li>File & Printer sharing,enabled.</li></ul>                                                                                                                                                                                                                                                                                                                                                                 | <ul><li>WinRM HTTP port (default 5985) opened in Firewall.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                           |
| 2    | Domain joined machine in Corp network                      | Trusted                                    | DNS name         | Domain account                            | Kerberos            | Machine Administrator                               | WinRM HTTPS     | <ul><li>WinRM HTTPS port  (default 5986) opened in Firewall.</li><li>Trusted certificate in Automation agent.</li><li>If Trusted certificate not in Automation agent then SkipCA option enabled in Task for deployment.</li><li>File & Printer sharing enabled.</li></ul>                                                                                                                                                                                                    | <ul><li>WinRM HTTPS port  (default 5986) opened in Firewall.</li><li>Trusted certificate in Automation agent.</li><li>If Trusted certificate not in Automation agent then SkipCA option enabled in Task for deployment.</li></ul>                                                                                                                                                                                                                              |
| 3    | Domain joined machine,or Workgroup machine in Corp network | Any                                        | DNS name         | Local machine account                     | NTLM                | Machine Administrator                               | WinRM HTTP      | <ul><li>WinRM HTTP port (default 5985) opened in Firewall.</li><li>Disable UAC remote restrictions <a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format</li><li>Set "AllowUnencrypted" option and add remote machines in "Trusted Host" list in Automation Agent <a href="https://msdn.microsoft.com/en-us/library/aa384372(v=vs.85).aspx">(link)</a></li><li>File & Printer sharing enabled</li></ul>    | <ul><li>WinRM HTTP port (default 5985) opened in Firewall.</li><li>Disable UAC remote restrictions<a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format.</li><li>Set "AllowUnencrypted" option and add remote machines in "Trusted Host" list in Automation Agent<a href="https://msdn.microsoft.com/en-us/library/aa384372(v=vs.85).aspx">(link)</a></li></ul>                              |
| 4    | Domain joined machine or Workgroup machine,in Corp network | Any                                        | DNS name         | Local machine account                     | NTLM                | Machine Administrator                               | WinRM HTTPS     | <ul><li>WinRM HTTPS port  (default 5986) opened in Firewall.</li><li>Disable UAC remote restrictions<a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format.</li><li>Trusted certificate in Automation agent.</li><li>If Trusted certificate not in Automation agent then SkipCA option enabled in Task for deployment.</li><li>File & Printer sharing enabled.</li></ul>                                    | <ul><li>WinRM HTTPS port  (default 5986) opened in Firewall.</li><li>Disable UAC remote restrictions<a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format.</li><li>Trusted certificate in Automation agent.</li><li>If Trusted certificate not in Automation agent then SkipCA option enabled in Task for deployment.</li></ul>                                                              |
| 5    | Workgroup machine in Azure                                 | Un Trusted                                 | DNS name         | Local machine account or MAS/Live account | NTLM                | Machine Administrator                               | WinRM HTTP      | <ul><li>WinRM HTTP port (default 5985) opened in Firewall.</li><li>Disable UAC remote restrictions<a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format.</li><li>Set "AllowUnencrypted" option and add remote machines in "Trusted Host" list in Automation Agent <a href="https://msdn.microsoft.com/en-us/library/aa384372(v=vs.85).aspx">(link)</a></li></ul>                                           | <ul><li>WinRM HTTP port (default 5985) opened in Firewall.</li><li>Disable UAC remote restrictions<a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format.</li><li>Set "AllowUnencrypted" option and add remote machines in "Trusted Host" list in Automation Agent<a href="https://msdn.microsoft.com/en-us/library/aa384372(v=vs.85).aspx">(link)</a></li></ul>                              |
| 6    | Workgroup machine in Azure                                 | Un Trusted                                 | DNS name         | Local machine account or MAS/Live account | NTLM                | Machine Administrator                               | WinRM HTTPS     | <ul><li>WinRM HTTPS port  (default 5986) opened in Firewall.</li><li>Disable UAC remote restrictions<a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format.</li><li>Trusted certificate in Automation agent.</li><li>If Trusted certificate not in Automation agent then SkipCA option enabled in Task for deployment.</li></ul>                                                                            | <ul><li>WinRM HTTPS port  (default 5986) opened in Firewall.</li><li>Disable UAC remote restrictions<a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format.</li><li>Trusted certificate in Automation agent.</li><li>If Trusted certificate not in Automation agent then SkipCA option enabled in Task for deployment.</li></ul>                                                              |
| 7    | Any                                                        | Any                                        | IP address       | Any                                       | NTLM                | Machine Administrator                               | WinRM HTTP      | <ul><li>WinRM HTTP port (default 5985) opened in Firewall.</li><li>Disable UAC remote restrictions <a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format</li><li>Set "AllowUnencrypted" option and add remote machines in "Trusted Host" list in Automation Agent <a href="https://msdn.microsoft.com/en-us/library/aa384372(v=vs.85).aspx">(link)</a></li><li>File & Printer sharing enabled</li></ul>    | <ul><li>WinRM HTTP port (default 5985) opened in Firewall.</li><li>Disable UAC remote restrictions<a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format.</li><li>Set "AllowUnencrypted" option and add remote machines in "Trusted Host" list in Automation Agent<a href="https://msdn.microsoft.com/en-us/library/aa384372(v=vs.85).aspx">(link)</a></li></ul>                              |
| 8    | Any                                                        | Any                                        | IP address       | Any                                       | NTLM                | Machine Administrator                               | WinRM HTTPS     | <ul><li>WinRM HTTPS port  (default 5986) opened in Firewall.</li><li>Disable UAC remote restrictions<a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format.</li><li>Trusted certificate in Automation agent.</li><li>If Trusted certificate not in Automation agent then SkipCA option enabled in Task for deployment.</li><li>File & Printer sharing enabled.</li></ul>                                    | <ul><li>WinRM HTTPS port  (default 5986) opened in Firewall.</li><li>Disable UAC remote restrictions<a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format.</li><li>Trusted certificate in Automation agent.</li><li>If Trusted certificate not in Automation agent then SkipCA option enabled in Task for deployment.</li></ul>                                                              |
| 9    | AADjoined machine in Azure                                 | Un Trusted                                 | DNS name         | AAD account                               |                     | Machine Administrator                               | WinRM HTTP      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | <ul><li>WinRM port 5985 (Firewall opened, NTLM authentication enabled(winrm qc will do all this).</li><li>Add remote computers to "Trusted Host".</li><li>Disable UAC remote restrictions<a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li></ul>                                                                                                                                                                                          |
| 10   | AAD joined machine in Azure                                | Un Trusted                                 | DNS name         | AAD account                               |                     | Machine Administrator                               | WinRM HTTPS     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | <ul><li>WinRM port 5986(Self-signed cert with proper CN name and server authentication enabled or have trusted authority cert).</li><li>Trusted certificate in Automation agent Trust the CA authority in the agent, or trust the self signed cert, or have SKipCACHeck if can't do both. Firewall opened, NTLM authentication enabled.</li><li>Disable UAC remote restrictions<a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li></ul>    |
